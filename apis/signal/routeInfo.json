{"path":"apis/signal","templateID":1,"sharedPropsHashes":{"apiList":"2yCeH"},"localProps":{"reference":{"title":"シグナル","slug":"apis/signal","description":"「シグナル」のAPIでの利用方法","order":15,"navi":"APIでの利用方法","contents":"<h2 id=\"-\">目次</h2>\n<ul>\n<li><a href=\"#%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%81%AE%E9%80%81%E4%BF%A1\">グローバルシグナルの送信</a></li>\n<li><a href=\"#%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%81%AE%E5%8F%96%E5%BE%97\">グローバルシグナルの取得</a></li>\n<li><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%81%AE%E9%80%81%E4%BF%A1\">ユーザーシグナルの送信</a></li>\n<li><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%81%AE%E5%8F%96%E5%BE%97\">ユーザーシグナルの取得</a></li>\n</ul>\n<h2 id=\"-\">グローバルシグナル</h2>\n<h3 id=\"-\">グローバルシグナルの送信</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.signal.sendSignalToGlobal(data: string)</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">ゲームのグローバルシグナルとして <code>data</code> で指定した文字列を送信します。</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\"><code>data</code> : シグナルとして、任意の文字列を100byte以内で送信できます。</td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;void&gt;</code></td>\n</tr>\n</tbody></table>\n<ul>\n<li>グローバルシグナルは1ゲームあたり1,000件まで保存されます。</li>\n</ul>\n<h4 id=\"-\">起こりうるエラーの種類</h4>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">UNAUTHORIZED</a></td>\n<td align=\"left\">プレイヤーがログインしていない</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">BAD_REQUEST</a></td>\n<td align=\"left\"><ul><li><code>data</code> に100byte以上の文字列を指定した</li><li>引数として不正な値を指定している</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h3 id=\"-\">グローバルシグナルの取得</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.signal.getGlobalSignals()</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">送信されたゲームのグローバルシグナルを取得します。</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\">なし</td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;GlobalSignal[]&gt;</code></td>\n</tr>\n</tbody></table>\n<ul>\n<li>グローバルシグナルは1ゲームあたり1,000件まで保存されます。</li>\n</ul>\n<h4 id=\"-globalsignal-\">戻り値の型 GlobalSignal について</h4>\n<p>戻り値で取得できる <code>GlobalSignal</code> は以下のような型です。</p>\n<pre><code class=\"language-js\">interface GlobalSignal {\n    id: number;\n    senderId: number;\n    senderName: string;\n    data: string;\n    createdAt: number;\n}</code></pre>\n<p>プロパティの内容は次のようになっています。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">プロパティ</th>\n<th align=\"left\">型</th>\n<th align=\"left\">内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">d</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">シグナルそれぞれでユニークなID値</td>\n</tr>\n<tr>\n<td align=\"left\">senderId</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">シグナルを送信したユーザーのニコニコユーザーID</td>\n</tr>\n<tr>\n<td align=\"left\">senderName</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">シグナルを送信したユーザーのユーザー名</td>\n</tr>\n<tr>\n<td align=\"left\">data</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">送信したシグナル文字列</td>\n</tr>\n<tr>\n<td align=\"left\">createdAt</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">シグナルが送信された日時(秒単位のunix timestamp)。すでに処理済みのシグナルを判別するために用います。</td>\n</tr>\n</tbody></table>\n<h4 id=\"-\">戻り値の例</h4>\n<pre><code class=\"language-js\">// window.RPGAtsumaru.signal.getGlobalSignals().then(function(v) { console.log(v) }) を実行\n[\n  {\n    createdAt: 1543397700,\n    data: &quot;test data&quot;,\n    id: 3,\n    senderId: 12345,\n    senderName: &quot;user1&quot;\n  },\n  {\n    createdAt: 1543397701,\n    data: &quot;test data2&quot;,\n    id: 4,\n    senderId: 12346,\n    senderName: &quot;user2&quot;\n  },\n]</code></pre>\n<h4 id=\"-\">起こりうるエラーの種類</h4>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">ユーザーシグナル</h2>\n<h3 id=\"-\">ユーザーシグナルの送信</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.signal.sendSignalToUser(receiverId: number, data: string)</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">ユーザーシグナルとして <code>receiverId</code> で指定したユーザーIDのユーザーに <code>data</code> で指定した文字列を送信します。</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\"><ul><li><code>receiverId</code> : 送信先のニコニコユーザーIDを指定します。</li><li><code>data</code> : シグナルとして、任意の文字列を100byte以内で送信できます。</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;void&gt;</code></td>\n</tr>\n</tbody></table>\n<ul>\n<li>ユーザーシグナルは、ユーザーあたり100KBまで保存されます。</li>\n<li>他のゲームからのシグナル送信によっても消える可能性があります。</li>\n<li>また、ゲームあたり1ユーザー10KBまたは1000件までとなります。</li>\n<li>ゲームからのシグナル送信によって、古いシグナルから消えていきます。</li>\n</ul>\n<h4 id=\"-\">起こりうるエラーの種類</h4>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">UNAUTHORIZED</a></td>\n<td align=\"left\">プレイヤーがログインしていない</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">FORBIDDEN</a></td>\n<td align=\"left\"><code>userId</code> に<a href=\"/common/interplayer\">プレイヤー間通信の有効化</a>を行っていないユーザーのIDを指定した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">BAD_REQUEST</a></td>\n<td align=\"left\"><ul><li><code>data</code> に100byte以上の文字列を指定した</li><li>引数として不正な値を指定している</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h3 id=\"-\">ユーザーシグナルの取得</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.signal.getUserSignals()</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">プレイしているユーザーのユーザーシグナルを取得します。</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\">なし</td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;UserSignal[]&gt;</code></td>\n</tr>\n</tbody></table>\n<ul>\n<li>ユーザーシグナルは、ユーザーあたり100KBまで保存されます。</li>\n<li>他のゲームからのシグナル送信によっても消える可能性があります。</li>\n<li>また、ゲームあたり1ユーザー10KBまたは1000件までとなります。</li>\n<li>ゲームからのシグナル送信によって、古いシグナルから消えていきます。<h4 id=\"-usersignal-\">戻り値の型 UserSignal について</h4>\n戻り値で取得できる <code>UserSignal</code> は以下のような型です。</li>\n</ul>\n<pre><code class=\"language-js\">interface UserSignal {\n    id: number;\n    senderId: number;\n    senderName: string;\n    data: string;\n    createdAt: number;\n}</code></pre>\n<p>プロパティの内容は次のようになっています。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">プロパティ</th>\n<th align=\"left\">型</th>\n<th align=\"left\">内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">id</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">シグナルそれぞれでユニークなID値</td>\n</tr>\n<tr>\n<td align=\"left\">senderId</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">シグナルを送信したユーザーのニコニコユーザーID</td>\n</tr>\n<tr>\n<td align=\"left\">senderName</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">シグナルを送信したユーザーのユーザー名</td>\n</tr>\n<tr>\n<td align=\"left\">data</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">送信したシグナル文字列</td>\n</tr>\n<tr>\n<td align=\"left\">createdAt</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">シグナルが送信された日時(秒単位のunix timestamp)。すでに処理済みのシグナルを判別するために用います。</td>\n</tr>\n</tbody></table>\n<h4 id=\"-\">戻り値の例</h4>\n<pre><code class=\"language-js\">// window.RPGAtsumaru.signal.getUserSignals().then(function(v) { console.log(v) }) を実行\n[\n  {\n    createdAt: 1543397700,\n    data: &quot;test data&quot;,\n    id: 3,\n    senderId: 12345,\n    senderName: &quot;user1&quot;\n  },\n  {\n    createdAt: 1543397701,\n    data: &quot;test data2&quot;,\n    id: 4,\n    senderId: 12346,\n    senderName: &quot;user2&quot;\n  },\n]</code></pre>\n<h4 id=\"-\">起こりうるエラーの種類</h4>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">UNAUTHORIZED</a></td>\n<td align=\"left\">プレイヤーがログインしていない</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">関連ドキュメント</h2>\n<table>\n<thead>\n<tr>\n<th align=\"left\">ドキュメント</th>\n<th align=\"left\">リンク</th>\n<th align=\"left\">備考</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">機能解説</td>\n<td align=\"left\"><a href=\"/signal\">シグナル</a></td>\n<td align=\"left\">機能概要や全般的な解説</td>\n</tr>\n<tr>\n<td align=\"left\">プラグインでの利用方法</td>\n<td align=\"left\"><a href=\"/plugins/signal\">シグナル</a></td>\n<td align=\"left\">RPGツクールMVユーザー向け</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">最終更新日</h2>\n<ul>\n<li>2020/02/28</li>\n</ul>\n"},"title":"シグナル","path":"/apis/signal"}}
